<!DOCTYPE html>
<html>
<head>
<meta charset="UTF-8">
<title>School Display</title>
<style>
body {
  margin: 0;
  background: black;
  color: white;
  font-family: Arial, sans-serif;
}
#screen {
  width: 100vw;
  height: 100vh;
  display: flex;
  align-items: center;
  justify-content: center;
  text-align: center;
  font-size: 60px;
  padding: 40px;
}
img {
  max-width: 100%;
  max-height: 100%;
}
</style>
</head>
<body>

<div id="screen">Yüklənir...</div>

<script>
// Google Sheet ID
const SHEET_ID = "15ki7QHp7im0db6WGmUDjR8vxm-LP4l0FXhMQ8s8egUU";
// Sheet adı (tam olaraq Google Sheet-də görünən adı)
const SHEET_NAME = "Sheet1";
// JSON API linki
const url = `https://opensheet.elk.sh/${SHEET_ID}/${SHEET_NAME}`;

let items = [];
let index = 0;

// Sheet-dən məlumatları çəkmək
async function loadData() {
  try {
    const res = await fetch(url);
    const data = await res.json();

    // JSON boş deyil və aktiv olanları götür
    if(Array.isArray(data) && data.length > 0) {
      items = data.filter(i => i.active === "1");
      index = 0;
      show();
    } else {
      document.getElementById("screen").innerText = "Sheet boş və ya səhv!";
    }

  } catch(e) {
    document.getElementById("screen").innerText = "Bağlantı yoxdur";
  }
}

// Ekranda göstərmək
function show() {
  if (items.length === 0) return;

  const item = items[index];
  const screen = document.getElementById("screen");

  if(item.type === "image" && item.image) {
    screen.innerHTML = `<img src="${item.image}" alt="Elan">`;
  } else if(item.type === "text") {
    screen.innerHTML = `<div><b>${item.title}</b><br><br>${item.text}</div>`;
  }

  // Növbəti item-ə keçmək
  setTimeout(() => {
    index = (index + 1) % items.length;
    show();
  }, Number(item.duration) * 1000);
}

// İlk yükləmə
loadData();
// Sheet-i hər 60 saniyədə yenilə
setInterval(loadData, 60000);
</script>

</body>
</html>
